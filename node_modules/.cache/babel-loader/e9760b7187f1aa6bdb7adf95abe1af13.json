{"ast":null,"code":"import React,{useState,useContext,useEffect}from'react';import{renderIntoDocument}from'react-dom/test-utils';import Context from'./context';import productsData from'./json/products.json';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CartAdd=function CartAdd(){var _useContext=useContext(Context),cart=_useContext.cart,setCart=_useContext.setCart,totalCost=_useContext.totalCost,setTotalCost=_useContext.setTotalCost;var cartProduct=[];var cartProductJsx=/*#__PURE__*/_jsx(\"div\",{className:\"cart-item\",children:/*#__PURE__*/_jsx(\"div\",{className:\"cart-empty-text\",children:\"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430 \\u043F\\u0443\\u0441\\u0442\\u0430\"})});var deleteItem=function deleteItem(event){var elem=event.target.closest('.cart-item');var itemType=elem.dataset.type;var itemId=elem.dataset.id;var cartObj=JSON.parse(cart);var cartObj2=JSON.parse(cart);if(cartObj[itemType].indexOf(itemId)!=-1){cartObj2=cartObj2[itemType];cartObj2.forEach(function(item,index){if(item===itemId){delete cartObj[itemType][index];}});cartObj[itemType]=cartObj[itemType].filter(function(item){if(item)return item;});var cartStr=JSON.stringify(cartObj);setCart(cartStr);}};var minusItem=function minusItem(event){var elem=event.target.closest('.cart-item');var itemType=elem.dataset.type;var itemId=elem.dataset.id;var cartObj=JSON.parse(cart);var index=cartObj[itemType].indexOf(itemId);cartObj[itemType].splice(index,1);var cartStr=JSON.stringify(cartObj);setCart(cartStr);};var plusItem=function plusItem(event){var elem=event.target.closest('.cart-item');var itemType=elem.dataset.type;var itemId=elem.dataset.id;var cartObj=JSON.parse(cart);var index=cartObj[itemType].indexOf(itemId);cartObj[itemType].push(cartObj[itemType][index]);var cartStr=JSON.stringify(cartObj);setCart(cartStr);};var summa;var changeSumm=function changeSumm(summ){summa=summ;return summa;};useEffect(function(){if(summa===undefined)summa=0;setTotalCost(summa);},[changeSumm]);if(cart.length===0){return cartProductJsx;}else{var cartData=JSON.parse(cart);var keys=Object.keys(cartData);keys.forEach(function(key){cartData[key].forEach(function(indexProduct){productsData[key]['product'+(+indexProduct+1)].type=key;productsData[key]['product'+(+indexProduct+1)].id=indexProduct;cartProduct.push(productsData[key]['product'+(+indexProduct+1)]);});});if(cartProduct.length!==0){console.log(cartProduct);var cartProductRendered=[];var summTotalCost=0;cartProductJsx=cartProduct.map(function(item,index){var cartObj=JSON.parse(cart);var amount=0;cartObj[item.type].forEach(function(cartItem){if(cartItem===item.id)amount++;});if(amount===0){amount=1;summTotalCost=0;}if(cartProductRendered.indexOf(item.id+item.type)===-1){cartProductRendered.push(item.id+item.type);var itemCost=Number((parseFloat(item.cost.replace(',','.'))*amount).toFixed(2));summTotalCost+=itemCost;return/*#__PURE__*/_jsxs(\"div\",{className:\"cart-item\",\"data-index\":index,\"data-id\":item.id,\"data-type\":item.type,children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-image\",children:/*#__PURE__*/_jsx(\"div\",{className:\"image-wrapper\",children:/*#__PURE__*/_jsx(\"img\",{src:item.img})})}),/*#__PURE__*/_jsx(\"div\",{className:\"item-title\",children:item.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-amount\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"amount-changer\",onClick:minusItem,children:/*#__PURE__*/_jsx(\"span\",{children:\"-\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"amount\",children:amount}),/*#__PURE__*/_jsx(\"div\",{className:\"amount-changer\",onClick:plusItem,children:/*#__PURE__*/_jsx(\"span\",{children:\"+\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"item-price\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"price-value\",children:[itemCost,\" \\u0440\\u0443\\u0431.\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"item-delete\",children:/*#__PURE__*/_jsx(\"div\",{className:\"delete-btn\",onClick:deleteItem,children:/*#__PURE__*/_jsx(\"div\",{className:\"cross\"})})})]},index);}});changeSumm(Number(summTotalCost.toFixed(1)));}return cartProductJsx;}};export default CartAdd;","map":{"version":3,"sources":["/Users/alex.vysocki/Desktop/Project/pizza-app/src/CartAdd.js"],"names":["React","useState","useContext","useEffect","renderIntoDocument","Context","productsData","CartAdd","cart","setCart","totalCost","setTotalCost","cartProduct","cartProductJsx","deleteItem","event","elem","target","closest","itemType","dataset","type","itemId","id","cartObj","JSON","parse","cartObj2","indexOf","forEach","item","index","filter","cartStr","stringify","minusItem","splice","plusItem","push","summa","changeSumm","summ","undefined","length","cartData","keys","Object","key","indexProduct","console","log","cartProductRendered","summTotalCost","map","amount","cartItem","itemCost","Number","parseFloat","cost","replace","toFixed","img","name"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react';\nimport { renderIntoDocument } from 'react-dom/test-utils';\nimport Context from './context';\n\nimport productsData from './json/products.json';\n\nconst CartAdd = function() {\n\n    let {cart, setCart, totalCost, setTotalCost} = useContext(Context);\n\n    let cartProduct = [];\n    let cartProductJsx = <div className='cart-item'><div className=\"cart-empty-text\">Корзина пуста</div></div>;\n\n    const deleteItem = function (event) {\n\n        const elem = event.target.closest('.cart-item');\n        \n        const itemType = elem.dataset.type;\n        const itemId= elem.dataset.id;\n\n        const cartObj = JSON.parse(cart);\n        let cartObj2 = JSON.parse(cart);\n\n\n        if (cartObj[itemType].indexOf(itemId) != -1) {\n            cartObj2 = cartObj2[itemType];\n\n            cartObj2.forEach((item, index) => {\n                if (item === itemId) {\n                    delete cartObj[itemType][index]\n                }\n            });\n\n            cartObj[itemType] = cartObj[itemType].filter(item => {\n                if (item) return item;\n            });\n\n            const cartStr = JSON.stringify(cartObj);\n\n            setCart(cartStr);\n        }\n    };\n    \n    const minusItem = function (event) {\n        const elem = event.target.closest('.cart-item');\n        \n        const itemType = elem.dataset.type;\n        const itemId= elem.dataset.id;\n\n        const cartObj = JSON.parse(cart);\n\n        const index = cartObj[itemType].indexOf(itemId);\n\n        cartObj[itemType].splice(index, 1);\n\n        const cartStr = JSON.stringify(cartObj);\n\n        setCart(cartStr);\n\n    };\n\n    const plusItem = function (event) {\n        const elem = event.target.closest('.cart-item');\n        \n        const itemType = elem.dataset.type;\n        const itemId= elem.dataset.id;\n\n        const cartObj = JSON.parse(cart);\n\n        const index = cartObj[itemType].indexOf(itemId);\n\n        cartObj[itemType].push(cartObj[itemType][index]);\n\n        const cartStr = JSON.stringify(cartObj);\n\n        setCart(cartStr);\n\n    };\n\n    let summa;\n\n    const changeSumm = function (summ) {\n        summa = summ;\n        return summa;\n    };\n\n    useEffect(function () {\n        if(summa === undefined) summa = 0;\n\t\tsetTotalCost(summa)\n\t}, [changeSumm]);\n\n    if (cart.length === 0) {\n        return cartProductJsx;\n    } else {\n        let cartData = JSON.parse(cart);\n\n        let keys = Object.keys(cartData)\n\n\n        keys.forEach(key => {\n            cartData[key].forEach(indexProduct => {\n                productsData[key]['product' + (+indexProduct + 1)].type = key;\n                productsData[key]['product' + (+indexProduct + 1)].id = indexProduct;\n                cartProduct.push(productsData[key]['product' + (+indexProduct + 1)])\n            });\n        });\n\n\n        if (cartProduct.length !== 0) {\n\n            console.log(cartProduct)\n\n            let cartProductRendered = [];\n\n            let summTotalCost = 0;\n           \n            cartProductJsx = cartProduct.map((item, index) => {\n\n                let cartObj = JSON.parse(cart);\n                let amount = 0;\n\n                cartObj[item.type].forEach(cartItem => {\n                    if (cartItem === item.id) amount++;\n                })\n\n                if(amount === 0) {\n                    amount = 1;\n                    summTotalCost = 0;\n                }\n\n                if (cartProductRendered.indexOf(item.id+item.type) === -1) {\n                    cartProductRendered.push(item.id+item.type);\n\n                    let itemCost = Number((parseFloat(item.cost.replace(',', '.'))*amount).toFixed(2));\n                    summTotalCost += itemCost;\n\n                    return <div className=\"cart-item\" key={index} data-index={index} data-id={item.id} data-type={item.type}>\n                        <div className=\"item-image\"><div className='image-wrapper'><img src={item.img}></img></div></div>\n                        <div className=\"item-title\">{item.name}</div>\n                        <div className=\"item-amount\">\n                            <div className=\"amount-changer\" onClick={minusItem}><span>-</span></div>\n                            <div className=\"amount\">{amount}</div>\n                            <div className=\"amount-changer\" onClick={plusItem}><span>+</span></div>\n                        </div>\n                        <div className=\"item-price\"><span className=\"price-value\">{itemCost} руб.</span></div>\n                        <div className=\"item-delete\"><div className=\"delete-btn\" onClick={deleteItem}><div className=\"cross\"></div></div></div>\n                    </div>\n                }\n\n            })\n\n            changeSumm(Number(summTotalCost.toFixed(1)));\n        }\n\n        return cartProductJsx;\n    }\n};\n\nexport default CartAdd;"]},"metadata":{},"sourceType":"module"}